echo "ğŸ” Running pre-commit checks..."

# Check if we're in the root directory
if [ ! -f "package.json" ]; then
  echo "âŒ Error: Not in project root directory"
  exit 1
fi

# Run frontend format check
echo "ğŸ“ Checking frontend formatting..."
if ! npm run format:check:frontend; then
  echo "âš ï¸  Frontend formatting issues found. Auto-fixing..."
  npm run format:frontend
  echo "âœ… Frontend formatting fixed. Please review and re-commit."
fi

# Run backend format check
echo "ğŸ“ Checking backend formatting..."
if ! npm run format:check:backend; then
  echo "âš ï¸  Backend formatting issues found. Auto-fixing..."
  npm run format:backend
  echo "âœ… Backend formatting fixed. Please review and re-commit."
fi

# Run frontend linting (allow warnings, only fail on errors)
echo "ğŸ” Running frontend linting..."
if ! npm run lint:frontend; then
  echo "âš ï¸  Frontend linting issues found. Some issues may need manual fixing."
  echo "ğŸ’¡ Run 'npm run lint:fix:frontend' to auto-fix what's possible."
  echo "ğŸ“ Review the linting output above and fix critical errors before committing."
  # Don't exit on linting errors for now, just warn
fi

# Run backend linting (allow warnings, only fail on critical errors)
echo "ğŸ” Running backend linting..."
if ! npm run lint:backend; then
  echo "âš ï¸  Backend linting issues found. Some issues may need manual fixing."
  echo "ğŸ’¡ Run 'npm run lint:fix:backend' to auto-fix what's possible."
  echo "ğŸ“ Review the linting output above and fix critical errors before committing."
  # Don't exit on linting errors for now, just warn
fi

echo "âœ… Pre-commit checks completed!"
echo "ğŸ“‹ Note: Please review any linting warnings above and fix them when possible."
